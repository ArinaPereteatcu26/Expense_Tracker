<!-- HTML Component for the Home Page with Fixed Mobile Padding -->
<section class="text-black bg-white dark:bg-gray-900 body-font transition-all">
  <!-- Improved container padding for better mobile experience -->
  <div class="home-container px-6 sm:px-8 md:px-10 flex flex-col gap-y-8">
    <h1 class="mt-6 sm:mt-10 text-3xl sm:text-5xl md:text-7xl font-bold break-words text-gray-900 dark:text-gray-200">
      Welcome back, <span class="text-roseCustom">{{getUsername()}}</span>
    </h1>

    <div class="input-container flex flex-col lg:flex-row w-full gap-4 lg:gap-8 mt-2 md:mt-6">
      <!-- Budget Form -->
      <app-form-wrapper [formGroup]="budgetForm" class="w-full">
        <div class="input-form bg-white dark:bg-gray-700 rounded-xl shadow-sm p-5 sm:p-8 md:p-10 flex flex-col gap-y-4">
          <div class="flex items-center mb-2">
            <div class="h-8 w-10 rounded-full bg-customHsl-accent/10 flex items-center justify-center mr-3">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-customHsl-accent" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd" />
              </svg>
            </div>
            <h3 class="font-bold text-lg sm:text-xl textCustom dark:text-gray-200">Create Budget</h3>
          </div>

          <div class="text-inputs py-4 flex flex-col gap-y-2">
            <label for="budget-name" class="text-sm font-medium text-gray-700 dark:text-gray-300">Budget Name</label>
            <input
              id="budget-name"
              formControlName="name"
              type="text"
              class="input-select w-full p-4 text-base h-14 placeholder-gray-400 dark:bg-gray-800 dark:text-gray-200 dark:border-gray-600"
              placeholder="Budget Name"
            >
            <p *ngIf="budgetForm.get('name')?.invalid && budgetForm.get('name')?.touched"
               class="mt-1 text-sm text-red-600 dark:text-red-400">
              Please enter a budget name
            </p>
          </div>

          <div class="text-inputs flex flex-col gap-y-2">
            <label for="budget-amount" class="text-sm font-medium text-gray-700 dark:text-gray-300">Amount</label>
            <div class="relative">
              <input
                id="budget-amount"
                formControlName="budget"
                type="number"
                class="input-select w-full p-4 text-base h-14 placeholder-gray-400 dark:bg-gray-800 dark:text-gray-200 dark:border-gray-600"
                placeholder="MDL"
                min="0"
              >
            </div>
            <p *ngIf="budgetForm.get('budget')?.invalid && budgetForm.get('budget')?.touched"
               class="mt-1 text-sm text-red-600  dark:text-red-400">
              Please enter a valid amount
            </p>
          </div>

          <button
            [disabled]="budgetForm.invalid"
            (click)="addBudget()"
            class="mt-2 w-full sm:w-auto px-5 py-4 text-base rounded-lg bg-pink-300 hover:bg-pink-400 text-white dark:bg-gray-600 dark:hover:bg-gray-500 dark:text-white transition-all flex items-center justify-center gap-2 font-semibold">
            <span>Create Budget</span>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                 fill="currentColor" aria-hidden="true" class="w-5 h-5">
              <path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zM12.75 9a.75.75 0 00-1.5 0v5h5a1 1 0 110 2h-5v5a.75.75 0 001.5 0v-2.25H15a.75.75 0 000-1.5h-2.25V9z" clip-rule="evenodd"></path>
            </svg>
          </button>
        </div>
      </app-form-wrapper>

      <!-- Expense Form with improved padding -->
      <app-form-wrapper [formGroup]="expenseForm" class="w-full">
        <div class="input-form py-4 bg-white dark:bg-gray-700 rounded-xl shadow-sm p-5 sm:p-6 md:p-8 flex flex-col gap-y-5">
          <div class="flex py-4 items-center mb-2">
            <div class="h-8 w-8 rounded-full bg-red-100 flex items-center justify-center mr-3">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-red-500" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M5 3a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2V5a2 2 0 00-2-2H5zm0 2h10v7h-2l-1 2H8l-1-2H5V5z" clip-rule="evenodd" />
              </svg>
            </div>
            <h3 class="font-bold text-lg sm:text-xl textCustom dark:text-gray-200">Add New Expense</h3>
          </div>

          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div class="text-inputs flex flex-col gap-y-2">
              <label for="expense-name" class="text-sm font-medium text-gray-700 dark:text-gray-300">Expense Name</label>
              <input
                id="expense-name"
                formControlName="name"
                type="text"
                class="input-select w-full p-4 text-base h-14 placeholder-gray-400 dark:bg-gray-800 dark:text-gray-200 dark:border-gray-600"
                placeholder="e.g. Coffee"
              >
              <p *ngIf="expenseForm.get('name')?.invalid && expenseForm.get('name')?.touched"
                 class="mt-1 text-sm text-red-600 dark:text-red-400">
                Please enter an expense name
              </p>
            </div>

            <div class="text-inputs flex flex-col gap-y-2">
              <label for="expense-amount" class="text-sm font-medium text-gray-700 dark:text-gray-300">Amount</label>
              <div class="relative">
                <input
                  id="expense-amount"
                  formControlName="amount"
                  type="number"
                  class="input-select w-full p-4 text-base h-14 placeholder-gray-400 dark:bg-gray-800 dark:text-gray-200 dark:border-gray-600"
                  placeholder="MDL"
                  min="0"
                >
              </div>
              <p *ngIf="expenseForm.get('amount')?.invalid && expenseForm.get('amount')?.touched"
                 class="mt-1 text-sm text-red-600 dark:text-red-400">
                Please enter a valid amount
              </p>
            </div>
          </div>

          <div class="text-inputs flex flex-col gap-y-2">
            <label for="budget-category" class="text-sm font-medium text-gray-700 dark:text-gray-300">Budget Category</label>
            <div class="relative">
              <select
                id="budget-category"
                aria-label="Budget Category"
                formControlName="budgetCategoryId"
                class="input-select p-4 text-base h-14 pr-10 appearance-none w-full dark:bg-gray-800 dark:text-gray-200 dark:border-gray-600"
              >
                <option value="" disabled selected>Select a budget category</option>
                <ng-container *ngFor="let item of budgetCategories; let i = index">
                  <option [value]="item.id">{{item.name}}</option>
                </ng-container>
              </select>
              <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                </svg>
              </div>
            </div>
            <p *ngIf="expenseForm.get('budgetCategoryId')?.invalid && expenseForm.get('budgetCategoryId')?.touched"
               class="mt-1 text-sm text-red-600 dark:text-red-400">
              Please select a budget category
            </p>
          </div>

          <button
            [disabled]="expenseForm.invalid"
            (click)="addExpense()"
            class="mt-2 w-full py-4 text-base rounded-lg bg-customHsl-text text-white border-none font-semibold transition-all hover:bg-opacity-90"
          >
            Add Expense
          </button>
        </div>
      </app-form-wrapper>
    </div>

    <!-- Budgets Section -->
    @if(budgetCards && budgetCards.length > 0){
      <h2 class="mini-title font-bold text-lg sm:text-xl text-gray-800 dark:text-gray-200 mt-2">Existing Budgets</h2>
      <div class="flex w-full flex-wrap gap-4">
        @for(item of budgetCards; track $index){
          <app-budget-card class="budget-card" [config]="item"> </app-budget-card>
        }
      </div>
    }

    @if(expenseTableData && expenseTableData.length > 0){
      <h2 class="mini-title font-bold text-lg sm:text-xl text-gray-800 dark:text-white mt-4">Recent Expenses</h2>

      <app-table (removeRow)="handleDelete($event)" [data]="expenseTableData"></app-table>
    }

  </div>
  <app-footer class="mt-8"></app-footer>
</section>
